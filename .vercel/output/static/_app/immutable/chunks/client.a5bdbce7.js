async function m(n,t,e){const{callbackUrl:a=window.location.href,redirect:r=!0}=t??{},o=n==="credentials",l=o||n==="email",w=`${`/auth/${o?"callback":"signin"}/${n}`}?${new URLSearchParams(e)}`,u=await fetch("/auth/csrf"),{csrfToken:d}=await u.json(),i=await fetch(w,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({...t,csrfToken:d,callbackUrl:a})}),c=await i.clone().json(),h=new URL(c.url).searchParams.get("error");if(r||!l||!h){window.location.href=c.url??a,c.url.includes("#")&&window.location.reload();return}return i}async function R(n){const{callbackUrl:t=window.location.href}=n??{},e=await fetch("/auth/csrf"),{csrfToken:a}=await e.json(),s=(await(await fetch("/auth/signout",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({csrfToken:a,callbackUrl:t})})).json()).url??t;window.location.href=s,s.includes("#")&&window.location.reload()}export{m as a,R as s};
